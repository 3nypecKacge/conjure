#!/usr/bin/env sh

if [ $(git show -s --format=%ct HEAD) -gt $(stat -c %Y classes) ]; then
  echo "Compiling Conjure ahead of time."
  rm -rf classes
  mkdir classes
  clojure -Sforce -A:compile --eval "(compile 'conjure.main)"

  echo "Munging dependencies for injection at runtime."
  clojure -A:tools --main conjure.munge.main

  echo "Everything's ready! Let's perform some magic."
fi
